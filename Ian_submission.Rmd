---
title: "Assignment 2 Submission"
author: "Your name(s)"
date: "submission date"
output:
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Statement of Contribution

Include this if pairing.

State what each team member has contributed to the assignment before answering the questions. Each student must contribute towards ALL questions. Your assignment will not be marked without this statement.

```{r eval=FALSE, include=FALSE}
## There are a few options in every chunk, click the setting button (greyed) near the triangle:
# 1. to use default as in the above (show code and output, ie ECHO=TRUE) or 
# 2. to show output only (ie ECHO=FALSE) or
# 3. show nothing (run code) ie include=FALSE
# 4. show nothing (dont run the code), like this chunk, ie eval=FALSE, include=FALSE
## You can knit this template into Word and then update it into pdf etc..
## You can create your own way for submission, this is just an example if you are going to use Rmd.
```

# Question 1: Air Pollution and Mortality. Does pollution kill people? (30 marks)

(a) (5 marks) Carry out exploratory data analysis (EDA) of this dataset.

    **Answer:**
    
    I uhhh did this on my home pc will update once back

    *Answer text here*

    ```{r}
pollution <- read.csv("Pollution.csv")

#Climate EDA Plot
climate_variables <- pollution[, c("Mortality", "Precip", "Humidity", "JanTemp", "JulyTemp")]
pairs(climate_variables, main = "Climate Variables vs Mortality")



pollution <- read.csv("Pollution.csv")
    
#Climate EDA plot
climate_variables <- pollution[, c("Mortality", "Precip", "Humidity", "JanTemp", "JulyTemp")]
pairs(climate_variables, main = "Climate Variables vs Mortality")
  
#Socioeconomic EDA plot
socioeconomic_variables <- pollution[, c("Mortality", "Over65", "House", "Educ", "Sound", "Density", "NonWhite", "WhiteCol", "Poor")]
pairs(socioeconomic_variables, main = "Socioeconomic Variables vs Mortality")

#Pollution EDA plot
pollution_variables <- pollution[, c("Mortality", "HC", "NOX", "SO2")]
pairs(pollution_variables, main = "Pollution Variables vs Mortality")


#


    ```

(b) (9 marks) Perform model selection process using the all subset method to arrive at good regression models that account for variation in mortality between the cities that can be attributed to differences in climate and socioeconomic factors. Identify optimal model(s) based on each of the adjusted R2 , BIC and $C_p$. Use a maximum of 10 variables for the selection. For each criterion, state the number and names of the selected variables.

    **Answer:**

    *Answer text here*

    ```{r}
library(leaps)
source("all-subsets-lm.R")
  
data_thingy <- read.csv("Pollution.csv")

model <- lm(Mortality ~ Precip + Humidity + JanTemp + JulyTemp + 
                          Over65 + House + Educ + Sound + Density +
                          NonWhite + WhiteCol + Poor,
            data = data_thingy)

allsubsets_adjR2 <- all_subsets_lm(model, criterion = "adjR2")
allsubsets_bic   <- all_subsets_lm(model, criterion = "BIC")
allsubsets_c_p   <- all_subsets_lm(model, criterion = "Cp")

allsubsets_adjR2$variables
allsubsets_bic$variables
allsubsets_c_p$variables
    ```
    

(c) (4 marks) Fit the model with the lowest $C_p$ as obtained in (b). Write the equation of this fitted model. Interpret this model.

    **Answer:**

Equation: Mortality = 1242.0+  1.401 * Precip -1.684 * JanTemp - 2.8 * JulyTemp -16.16 * Educ + 0.00757 * Density + 5.275 * Nonwhite

Interpretation: Will write later aaaaaaaaaaaa

Things to mention: 

  Model Performance
    - R^2 / Variation
    - F-test (p value)
  Coefficient Interpretations 
    - legit just say what each thing does to the mortality
    
    *Answer text here*

    ```{r}
cp_model <- lm(Mortality ~ Precip + JanTemp + JulyTemp + Educ + Density + NonWhite, data = data_thingy)
    
summary(cp_model)


    ```

(d) (7 marks) Perform diagnostics checking on the model in (c). Do you think there are influential points in the data? Identify the cities which are influential points using leverage and Cook’s distance respectively.

    **Answer:**
Yes there are influential points in the data, those being 7,20,60 and 

    *Answer text here*

    ```{r}
    # Answer code here
plot(cp_model, which = 5, cook.levels = 4 / (nrow(data_thingy) - 2))

cooks_d <- cooks.distance(cp_model)
sort(cooks_d, decreasing = TRUE)[1:5]

    ```

(e) (5 marks) Using the model obtained in (c), add the three pollution variables (transformed to their natural logarithm) and obtain the p-value from the extrasum-of-squares F-test due to their addition. Summarise your findings in a few concise sentences.

    **Answer:**

    *Answer text here*

    ```{r}
    # Answer code here
    cp_model_expanded <- lm(Mortality ~ Precip + JanTemp + JulyTemp + Educ + Density + NonWhite + log(HC) + log(NOX) +log(SO2), data = data_thingy)
    
    cp_model <- lm(Mortality ~ Precip + Humidity + JanTemp + JulyTemp + 
                          Over65 + House + Educ + Sound + Density +
                          NonWhite + WhiteCol + Poor, data = data_thingy)
    
    
    anova(cp_model, cp_model_expanded)
    
    ```

# Question 2: Body Measurements (25 marks)

(a) (4 marks) Carry out exploratory data analysis (EDA) of this dataset before you do any modelling.

    **Answer:**

    *Answer text here*

(b) (10 marks) After the exploratory analysis has been carried out, split the dataset into a training set and a testing set so that the training set contains 80% of the data and the testing set contains 20%. Construct two multiple linear regression 3 models for this dataset using the training set based on the following variable selection methods: • (Model 1) The Forward selection; • (Model 2) The Backward selection. Write the two fitted model equations and compare them in a few concise sentences.

    **Answer:**

    *Answer text here*

    ```{r}
    # Answer code here
    ```

(c) (5 marks) Perform diagnostics checking for each of the final fitted models, Model 1 and Model 2 respectively.

    **Answer:**

    *Answer text here*

    ```{r}
    # Answer code here
    ```

(d) (6 marks). Despite any inadequacies that you may or may not have identified above, you use the two models obtained in (b) to make predictions of Weight in the test set.

(e) Produce a correctly drawn and labelled plot of predicted values against the actual values in the test set, and obtain the root mean squared error of prediction (RMSEP) based on each fitted model.

<!-- -->

(ii) Using the RMSEPs and the plots you produced, comment on how well the models performed.

````         
**Answer:**

*Answer text here*

```{r}
# Answer code here
```
````
